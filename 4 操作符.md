## 4.1 使用Java操作符

操作符接受一个或多个参数，然后生成一个新的值。

所有操作符都是通过它们的操作数来生成新值的。另外，有些操作符还会修改操作数自身的值，这也叫作"副作用"。

那些能修改操作数的操作符，其最常见的用途就是产生副作用。

几乎所有的操作符都只能操作基本类型。

## 4.2 优先级

当多个操作符同时存在时，操作符的优先级决定了表达式的计算顺序。Java对计算顺序做了特别规定。最简单的规则就是先乘除后加减。

当编译器看到一个字符串后面紧跟着一个`+`和一个非`String`类型的元素时，它会尝试着将这个非`String`类型的元素转换为`String`类型。

## 4.3 赋值

操作符`=`用来赋值。它的意思是"取等号右边的值（一般称作**右值**），把它复制给等号左边（一般称作**左值**）"。右值可以是任何常量、变量或者可以产生值的表达式。但左值必须是一个独特的变量名（也就是说，必须有一个物理空间来存储右值）。

基本类型的赋值是很直观的。基本类型存储了实际的值，而非指向一个对象的引用。所以在为其赋值的时候，你直接将一个地方的内容复制到了另一个地方。

将一个对象赋值给另一个对象，你其实是将这个引用从一个地方复制到另一个地方。

**方法调用中的别名**

```java
class Letter {
  char c;
}

public class PassObject {
  static void f(Letter y) {
    y.c = 'z';
  }
  public static void main(String[] args) {
    Letter x = new Letter();
    x.c = 'a';
    System.out.println("1: x.c: " + x.c);
    f(x);
    System.out.println("2: x.c: " + x.c);
  }
}
/* Output:
1: x.c: a
2: x.c: z
*/
```

## 4.4 算术操作符

Java的基本算术操作符与其他大多数编程语言相同，包括加法（`+`）、减法（`-`）、除法（`/`）、乘法（`*`）和取模（`%`，它从除法中产生余数）。整数除法的结果会舍弃小数位，而非四舍五入。

Java还使用一种来自C和C++的快捷运算符，可以同时进行运算和赋值操作。比如，把`x`加`4`，然后将结果赋回给`x`，可以这么写：`x += 4`。

## 4.5 自动递增和自动递减

递增操作符是`++`，意为"增加一个单位"；递减操作符是`--`，意为"减少一个单位"。

假设`a`是一个`int`值，则表达式`a++`就等价于`a = a + 1`。

递增和递减操作符不仅改变了变量，还会把变量的值作为生成的结果返回。

对于前缀递增和前缀递减（比如`++a`和`--a`），程序会先执行运算，然后返回生成的结果。

对于后缀递增和后缀递减（比如`a++`和`a--`），程序则会先返回变量的值，然后再执行运算。

## 4.6 关系操作符

关系操作符会根据操作数的值之间的关系生成一个布尔结果。如果关系为真，关系表达式会生成`true`；如果关系不为真，则生成`false`。

关系操作符包括小于`<`、大于`>`、小于等于`<=`、大于等于`>=`、等于`==`以及不等于`!=`。

在使用`Integer`的时候，你应该只使用`equals()`；如果使用了基本类型`int`，你就不能使用`equals()`而必须使用`==`和`!=`。

当一个非常大的数值减去一个相对较小的数值时，非常大的数值并不会发生显著变化。这叫作舍入误差。这种误差之所以发生，是因为机器不能存储足够的信息来表示一个大数值的微小变化。

```java
class ValA {
  int i;
}

class ValB {
  int i;
  // Works for this example, not a complete equals():
  public boolean equals(Object o) {
    ValB rval = (ValB)o;  // Cast o to be a ValB
    return i == rval.i;
  }
}

public class EqualsMethod {
  public static void main(String[] args) {
    ValA va1 = new ValA();
    ValA va2 = new ValA();
    va1.i = va2.i = 100;
    System.out.println(va1.equals(va2));
    ValB vb1 = new ValB();
    ValB vb2 = new ValB();
    vb1.i = vb2.i = 100;
    System.out.println(vb1.equals(vb2));
  }
}
/* Output:
false
true
*/
```

`equals()`方法的默认行为是比较引用。如果只想比较内容，必须重写`equals()`方法。

大多数标准库会重写`equals()`方法来比较对象的内容而不是它们的引用。

## 4.7 逻辑操作符

逻辑操作符包括与`&&`、或`||`和非`!`。

先使用关系比较操作符来生成布尔值结果，然后再对生成的布尔值进行逻辑运算。

### 短路

逻辑操作符支持一种称为"短路"的现象。一旦表达式当前部分的计算结果能够明确无误地确定整个表达式的值，表达式余下部分就不会被执行了。

## 4.8 字面量

一般来说，如果程序里使用了一个字面量，则编译器能准确地知道它是什么类型的。不过当类型模棱两可的时候，你就必须使用与该字面量相关的一些字符，以此添加额外的信息来引导编译器。

如果编译器能正确识别类型，就不需要数值后面的后缀字符。

## 4.9 按位操作符

按位操作符用来操作整数基本数据类型中的单个二进制位。

按位操作符源于C语言面向底层的设计，它经常需要直接操纵硬件，并直接设置硬件寄存器内的二进制位。

## 4.10 移位操作符

移位操作符只能用来处理基本类型里的整数类型。

## 4.11 三元操作符

```java
boolean-exp ? value0 : value1
```

## 4.12 字符串操作符+和+=

```java
public class StringOperators {
  public static void main(String[] args) {
    int x = 0, y = 1, z = 2;
    String s = "x, y, z ";
    System.out.println(s + x + y + z);
    // Converts x to a String:
    System.out.println(x + " " + s);
    s += "(summed) = "; // Concatenation operator
    System.out.println(s + (x + y + z));
    // Shorthand for Integer.toString():
    System.out.println("" + x); // 类型转换
  }
}
/* Output:
x, y, z 012
0 x, y, z
x, y, z (summed) = 3
0
*/
```

## 4.14 类型转换操作符

窄化转型就是说，将能容纳更多信息的数据类型转换成无法容纳那么多信息的数据类型。

执行窄化转型的操作，有可能面临信息丢失的危险。

### 4.14.1 截尾和舍入

将`float`或`double`转型为整型值时，总是对该数值执行截尾。如果想要对结果进行舍入，就需要使用`java.lang.Math`中的`round()`方法。

